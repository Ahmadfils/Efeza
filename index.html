<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="stylesheet" href="style.css" />
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
      <link rel="shortcut icon" href="img/E - eFeza.png" type="image/x-icon">
      <title>eFEZA BADGE</title>
   </head>
   <body>
      <div class="container">
         <img src="img/E - eFeza.png" class="campanylogo" alt="logo" srcset="">
         <div class="forms-container">
            <div class="fill">
               <form class="fill-form" id="userform">
                  <div class="profile-photo">
                     <i class="fas fa-camera"></i>
                     <img src="img/user.png" alt="default">
                     <input type="file" id="photoagent">
                  </div>
                  <div class="input-field">
                     <i class="fas fa-user"></i>
                     <input type="text" id="firstname" placeholder="First Name">
                  </div>
                  <span class="error-message" id="firstname-error"></span>
                  <div class="input-field">
                     <i class="fas fa-user"></i>
                     <input type="text" id="lastname" placeholder="Last Name">
                  </div>
                  <span class="error-message" id="lastname-error"></span>
                  <div class="input-field">
                     <i class="fas fa-phone"></i>
                     <input type="phone" id="phone" placeholder="Phone Number">
                  </div>
                  <span class="error-message" id="phone-error"></span>
                  <div class="input-field">
                     <i class="fas fa-lock"></i>
                     <input type="text" id="code" placeholder="Super Agent Code">
                  </div>
                  <span class="error-message" id="code-error"></span>
                  <input type="submit" value="Generate Badge" class="btn solid">
               </form>
               <!--------Peview Badge ------>
               <form action="#" class="fillblackets">
                  <div id="badge"  class="badge">
                     <div class="header">
                        <div class="logo">
                           <img height="70" src="img/logo efeza.png" alt="logo">
                        </div>
                     </div>
                     <div class="user-profile">
                        <img src="" alt="profile" >
                     </div>
                     <div class="footer">
                        <div class="user-details">
                           <h4><span id="namebadge"></span><br><span>SUPER  AGENT</span><br><br></h4>
                           <div>
                              <h5>TEL : <span id="phonebadge"> </span><br>
                                 CODE : <span id="codebadge"></span>
                              </h5>
                           </div>
                        </div>
                        <div class="sub_footer">
                           <div class="sub1_footer">
                              <div class="qrcode" id="qrcode">
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="action" style="margin-top: 20px;">
                     <button class="btn" id="imagebtn" >SAve AS IMAGE</button> <button class="btn" id="pdfbtn">SAve AS PDF</button> 
                  </div>
               </form>
            </div>
         </div>
         <div class="panels-container">
            <div class="panel left-panel">
               <div class="content">
                  <img id="logo" src="img/E - eFeza.png" class="image" alt="" />
                  <h3>eFEZA Umuhora wagutse </h3>
                  <p>
                     After filling User Information Press on this button to Preview Generated Badge 
                  </p>
                  <button class="btn transparent" id="preview-btn">
                  Preview Generated Badge
                  </button>
               </div>
            </div>
            <div class="panel right-panel">
               <div class="content">
                  <img  src="img/logo efeza.png" class="image" alt="" />
                  <button class="btn transparent" id="backtobadge">
                  Back to Generate Badge
                  </button>
               </div>
            </div>
         </div>
         <hr>
         <p class="copyright">
            Developped by Tr√©sor Kiddo 
         </p>
      </div>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
      <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.0.272/jspdf.debug.js"></script>
      <script>
         document.querySelector('.profile-photo i').addEventListener('click', function() {
           document.querySelector('.profile-photo input[type="file"]').click();
         });
         document.querySelector('.profile-photo input[type="file"]').addEventListener('change', function() {
           const file = this.files[0];
           if (file) {
               const reader = new FileReader();
               reader.onload = function(e) {
                   document.querySelector('.profile-photo img').src = e.target.result;
                   document.querySelector('.user-profile img').src = e.target.result;
               };
               reader.readAsDataURL(file);
           }
         });
         
         
      </script>
      <script>
         $(document).ready(function() {
           $('#pdfbtn').click(function() {
             html2canvas($('#badge')[0], {
                 dpi: 150, 
                 useCORS: true, 
             }).then(function(canvas) {
                 var imgData = canvas.toDataURL('image/jpeg');
                 var pdf = new jsPDF('portrait', 'mm', 'a4');
         
                 var imgWidth = 300;
                 var imgHeight = 400; 
         
                 var pageWidth = 210; 
                 var pageHeight = 297;
         
                 var marginLeft = (pageWidth - imgWidth * 0.264583); 
                 var marginTop = (pageHeight - imgHeight * 0.264583); 
         
                 pdf.addImage(imgData, 'JPEG', marginLeft/2, marginTop/4, imgWidth * 0.264583, imgHeight * 0.264583); 
                 pdf.save('badge.pdf');
             });
         });
         
             $('#imagebtn').click(function() {
                 html2canvas($('#badge')[0], {
                     scale: 2,
                     dpi: 150,
                     useCORS: true
                 }).then(function(canvas) {
                     var imgData = canvas.toDataURL('image/jpg');
                     var link = document.createElement('a');
                     link.href = imgData;
                     link.download = 'badge.jpg';
                     link.click();
                 });
             });
         });
      </script>
      <script src="app.js"></script>
      <script src="script.js"></script>
   </body>
</html>